<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:int="http://www.springframework.org/schema/integration"
	xmlns:int-sftp="http://www.springframework.org/schema/integration/sftp"
	xsi:schemaLocation="http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration-4.2.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/integration/sftp http://www.springframework.org/schema/integration/sftp/spring-integration-sftp.xsd">

	<import resource="sftp-common.xml"/>
	
	<int:gateway id="gw" service-interface="com.kirey.wscm.features.scheduling.jobs.tasklet.SftpGateway"
		default-request-channel="inbound"/>


	<int-sftp:outbound-gateway id="gatewayLS" 
		session-factory="sftpSessionFactory"
		request-channel="inbound"
		command="ls"
		command-options="-dirs"
		remote-file-separator="/"
		expression="payload"
		reply-channel="toSplitterLS">
		<!-- <int-sftp:request-handler-advice-chain>
			<int:retry-advice />
		</int-sftp:request-handler-advice-chain> -->
	</int-sftp:outbound-gateway>		


	<int:service-activator ref="sa" method="getMessage" input-channel="splittedLS"></int:service-activator>
	
	<int:channel id="inbound">
	</int:channel>
	
	<int:channel id="toSplitterLS">
	</int:channel>
	
	<int:splitter id="splitterLS"
	  input-channel="toSplitterLS" 
	  output-channel="splittedLS" >
	 </int:splitter>

	<int:channel id="splittedLS"/>
	
    
</beans>